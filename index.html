<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Isometric Maze Runner</title>
<style>
  body { margin:0; font-family:sans-serif; background:#eef4fa; overflow:hidden; }
  canvas { display:block; margin:auto; background:#2c2f36; }
  #ui {
    position:absolute; top:10px; left:10px; 
    background:white; padding:10px; border-radius:10px;
    box-shadow:0 2px 8px rgba(0,0,0,0.3);
  }
  #goalMsg {
    position:absolute; top:10px; right:10px;
    background:white; padding:10px; border-radius:10px;
    box-shadow:0 2px 8px rgba(0,0,0,0.3);
  }
</style>
</head>
<body>
<div id="ui">
  <p><b>Maze Runner</b></p>
  <p>ðŸŽ® Controls:<br>
  W/A/S/D or Arrows = Move<br>
  Reach the <span style="color:red;">RED TILE</span> to win!</p>
  <button onclick="newMaze()">New Maze</button>
</div>
<div id="goalMsg">Goal: Find the <span style="color:red;">red tile</span></div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const tileW = 40, tileH = 20;
const rows = 40, cols = 40;
let maze, player, goal, camera = {x:0, y:0};

function generateMaze(r, c) {
  let grid = Array.from({length:r},()=>Array(c).fill(1)); // 1 = wall
  function carve(x,y){
    const dirs = [[1,0],[-1,0],[0,1],[0,-1]].sort(()=>Math.random()-0.5);
    grid[y][x]=0;
    for(let [dx,dy] of dirs){
      let nx=x+dx*2, ny=y+dy*2;
      if(nx>=0&&ny>=0&&nx<c&&ny<r && grid[ny][nx]===1){
        grid[y+dy][x+dx]=0;
        carve(nx,ny);
      }
    }
  }
  carve(1,1);
  return grid;
}

function isoX(x,y){ return (x-y)*tileW/2; }
function isoY(x,y){ return (x+y)*tileH/2; }

function drawMaze(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const offsetX = canvas.width/2 + camera.x;
  const offsetY = 50 + camera.y; // lowered camera
  for(let y=0;y<rows;y++){
    for(let x=0;x<cols;x++){
      let sx = isoX(x,y)+offsetX;
      let sy = isoY(x,y)+offsetY;
      ctx.beginPath();
      ctx.moveTo(sx,sy);
      ctx.lineTo(sx+tileW/2, sy+tileH/2);
      ctx.lineTo(sx, sy+tileH);
      ctx.lineTo(sx-tileW/2, sy+tileH/2);
      ctx.closePath();
      if(goal.x===x && goal.y===y){
        ctx.fillStyle="red"; // goal tile
      } else {
        ctx.fillStyle = maze[y][x]===0 ? "#4caf50" : "#222";
      }
      ctx.fill();
    }
  }
  // player
  let px = isoX(player.x,player.y)+offsetX;
  let py = isoY(player.x,player.y)+offsetY;
  ctx.fillStyle="yellow";
  ctx.beginPath();
  ctx.arc(px,py,10,0,Math.PI*2);
  ctx.fill();

  // Win check
  if(player.x===goal.x && player.y===goal.y){
    ctx.fillStyle="white";
    ctx.font="30px Arial";
    ctx.fillText("ðŸŽ‰ You Win! ðŸŽ‰", canvas.width/2-70, 40);
  }
}

function newMaze(){
  maze = generateMaze(rows,cols);
  player={x:1,y:1};
  // pick random goal far away
  goal = {x:cols-2, y:rows-2};
  while(maze[goal.y][goal.x]!==0){
    goal={x:Math.floor(Math.random()*cols),y:Math.floor(Math.random()*rows)};
  }
  camera={x:0,y:0};
  drawMaze();
}

function move(dx,dy){
  let nx=player.x+dx, ny=player.y+dy;
  if(nx>=0&&ny>=0&&nx<cols&&ny<rows && maze[ny][nx]===0){
    player.x=nx; player.y=ny;
    // smaller camera movement (zoomed-in view)
    camera.x = -(isoX(nx,ny))/1.5; 
    camera.y = -(isoY(nx,ny))/1.5;
  }
  drawMaze();
}

document.addEventListener("keydown",e=>{
  if(e.key==="w"||e.key==="ArrowUp") move(0,-1);
  if(e.key==="s"||e.key==="ArrowDown") move(0,1);
  if(e.key==="a"||e.key==="ArrowLeft") move(-1,0);
  if(e.key==="d"||e.key==="ArrowRight") move(1,0);
});

newMaze();
</script>
</body>
</html>
